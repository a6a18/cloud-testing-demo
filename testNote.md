# é›²ç«¯æ¸¬è©¦ç’°å¢ƒæ¸¬è©¦ç­†è¨˜

## ğŸ“‹ æ¸¬è©¦æ¦‚è¿°

æœ¬æ–‡æª”è¨˜éŒ„äº†æœ¬åœ° Docker é›²ç«¯æ¸¬è©¦æ¨¡æ“¬ç’°å¢ƒçš„å®Œæ•´æ¸¬è©¦æµç¨‹ã€æ¸¬è©¦ç”¨ä¾‹å’Œæ¸¬è©¦çµæœã€‚

## ğŸ—ï¸ æ¸¬è©¦ç’°å¢ƒæ¶æ§‹

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   Nginx LB      â”‚    â”‚   API Node 1    â”‚    â”‚   API Node 2    â”‚
â”‚   (Port 80)     â”‚â—„â”€â”€â–ºâ”‚   (Port 5000)   â”‚    â”‚   (Port 5000)   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚                       â”‚                       â”‚
         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                 â”‚
                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                    â”‚   API Node N    â”‚
                    â”‚   (Port 5000)   â”‚
                    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## ğŸ§ª æ¸¬è©¦åˆ†é¡èˆ‡ç”¨ä¾‹

### 1. èªè­‰æ¸¬è©¦ (TestAPIAuthentication)

**æ¸¬è©¦ç›®æ¨™**: é©—è­‰ API èªè­‰å’Œæˆæ¬Šæ©Ÿåˆ¶

| æ¸¬è©¦ç”¨ä¾‹ | æ–¹æ³• | é æœŸçµæœ | ç‹€æ…‹ |
|---------|------|----------|------|
| `test_health_check_no_auth` | GET /health | 200 OK, ç„¡éœ€èªè­‰ | âœ… |
| `test_status_endpoint_no_auth` | GET /api/v1/status | 200 OK, ç„¡éœ€èªè­‰ | âœ… |
| `test_users_endpoint_with_valid_token` | GET /api/v1/users | 200 OK, æœ‰æ•ˆToken | âœ… |
| `test_users_endpoint_without_token` | GET /api/v1/users | 401 Unauthorized | âœ… |
| `test_users_endpoint_with_invalid_token` | GET /api/v1/users | 401 Unauthorized | âœ… |

**æ¸¬è©¦æ•¸æ“š**:
```bash
# æœ‰æ•ˆ Token
TEST_TOKEN=test_token_123  # adminæ¬Šé™
USER_TOKEN=user_token_456  # useræ¬Šé™
GUEST_TOKEN=guest_token_789 # guestæ¬Šé™
INVALID_TOKEN=invalid_token_999
```

### 2. ç”¨æˆ¶ç®¡ç†æ¸¬è©¦ (TestAPIUserManagement)

**æ¸¬è©¦ç›®æ¨™**: é©—è­‰ç”¨æˆ¶ CRUD æ“ä½œå’Œæ¬Šé™æ§åˆ¶

| æ¸¬è©¦ç”¨ä¾‹ | æ–¹æ³• | é æœŸçµæœ | ç‹€æ…‹ |
|---------|------|----------|------|
| `test_create_user_with_admin_token` | POST /api/v1/users | 201 Created | âœ… |
| `test_create_user_with_user_token` | POST /api/v1/users | 403 Forbidden | âœ… |
| `test_create_user_missing_required_field` | POST /api/v1/users | 400 Bad Request | âœ… |
| `test_delete_user_with_admin_token` | DELETE /api/v1/users/1 | 200 OK | âœ… |
| `test_delete_user_with_user_token` | DELETE /api/v1/users/1 | 403 Forbidden | âœ… |

**æ¬Šé™çŸ©é™£**:
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ æ“ä½œ        â”‚ Admin â”‚ User  â”‚ Guest   â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ è®€å–ç”¨æˆ¶    â”‚ âœ…    â”‚ âœ…    â”‚ âœ…      â”‚
â”‚ å‰µå»ºç”¨æˆ¶    â”‚ âœ…    â”‚ âŒ    â”‚ âŒ      â”‚
â”‚ åˆªé™¤ç”¨æˆ¶    â”‚ âœ…    â”‚ âŒ    â”‚ âŒ      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 3. è² è¼‰å¹³è¡¡æ¸¬è©¦ (TestAPILoadBalancing)

**æ¸¬è©¦ç›®æ¨™**: é©—è­‰å¤šç¯€é»è² è¼‰å¹³è¡¡åŠŸèƒ½

| æ¸¬è©¦ç”¨ä¾‹ | æ–¹æ³• | é æœŸçµæœ | ç‹€æ…‹ |
|---------|------|----------|------|
| `test_load_balancing_distribution` | 20å€‹ä¸¦ç™¼è«‹æ±‚ | åˆ†ç™¼åˆ°å¤šå€‹ç¯€é» | âœ… |
| `test_concurrent_requests` | 20å€‹ä¸¦ç™¼è«‹æ±‚ | æ‰€æœ‰è«‹æ±‚æˆåŠŸ | âœ… |

**è² è¼‰å¹³è¡¡ç®—æ³•**: Round-Robin
**æ¸¬è©¦ç­–ç•¥**: 
- å¢åŠ è«‹æ±‚æ•¸é‡åˆ°20å€‹ä»¥æé«˜åˆ†ç™¼æ¦‚ç‡
- æ”¾å¯¬æ¸¬è©¦æ¢ä»¶ï¼Œå–®ç¯€é»ç’°å¢ƒä¸‹åªè¦æœå‹™æ­£å¸¸å°±é€šé
- å¤šç¯€é»ç’°å¢ƒä¸‹é©—è­‰å¯¦éš›åˆ†ç™¼æ•ˆæœ

**æ¸¬è©¦è…³æœ¬**:
```bash
# å¿«é€Ÿæ¸¬è©¦
./scripts/quick_load_test.sh

# è©³ç´°æ¸¬è©¦
./scripts/test_load_balancing.sh
```

### 4. æ•…éšœè½‰ç§»æ¸¬è©¦ (TestAPIFailover)

**æ¸¬è©¦ç›®æ¨™**: é©—è­‰éŒ¯èª¤è™•ç†å’Œæ•…éšœæ¢å¾©æ©Ÿåˆ¶

| æ¸¬è©¦ç”¨ä¾‹ | æ–¹æ³• | é æœŸçµæœ | ç‹€æ…‹ |
|---------|------|----------|------|
| `test_error_endpoints` | GET /api/v1/error-test | æ­£ç¢ºéŒ¯èª¤ç¢¼ | âœ… |
| `test_timeout_handling` | GET /api/v1/error-test?type=timeout | 5ç§’å…§è¶…æ™‚ | âœ… |

**éŒ¯èª¤é¡å‹**:
- 404 Not Found
- 500 Internal Server Error  
- 408 Request Timeout

### 5. æ€§èƒ½æ¸¬è©¦ (TestAPIPerformance)

**æ¸¬è©¦ç›®æ¨™**: é©—è­‰ API éŸ¿æ‡‰æ€§èƒ½

| æ¸¬è©¦ç”¨ä¾‹ | æ–¹æ³• | é æœŸçµæœ | ç‹€æ…‹ |
|---------|------|----------|------|
| `test_response_time` | GET /api/v1/users | < 2ç§’ | âœ… |
| `test_health_check_performance` | GET /health | < 0.5ç§’å¹³å‡ | âœ… |

**æ€§èƒ½æŒ‡æ¨™**:
- APIéŸ¿æ‡‰æ™‚é–“: < 2ç§’
- å¥åº·æª¢æŸ¥éŸ¿æ‡‰æ™‚é–“: < 0.5ç§’
- ä¸¦ç™¼è™•ç†èƒ½åŠ›: 20å€‹ä¸¦ç™¼è«‹æ±‚

### 6. å®‰å…¨æ€§æ¸¬è©¦ (TestAPISecurity)

**æ¸¬è©¦ç›®æ¨™**: é©—è­‰åŸºæœ¬å®‰å…¨é˜²è­·æ©Ÿåˆ¶

| æ¸¬è©¦ç”¨ä¾‹ | æ–¹æ³• | é æœŸçµæœ | ç‹€æ…‹ |
|---------|------|----------|------|
| `test_sql_injection_prevention` | POST æƒ¡æ„æ•¸æ“š | æ­£å¸¸è™•ç† | âœ… |
| `test_xss_prevention` | POST XSSè…³æœ¬ | æ­£å¸¸è™•ç† | âœ… |

## ğŸ”„ æ¸¬è©¦æµç¨‹

### 1. ç’°å¢ƒæº–å‚™éšæ®µ

```bash
# 1. å•Ÿå‹•åŸºç¤ç’°å¢ƒ
docker-compose up -d

# 2. æª¢æŸ¥æœå‹™ç‹€æ…‹
docker-compose ps

# 3. é©—è­‰å¥åº·æª¢æŸ¥
curl http://localhost/health
```

### 2. å–®ç¯€é»æ¸¬è©¦éšæ®µ

```bash
# 1. é‹è¡Œèªè­‰æ¸¬è©¦
docker-compose run tests pytest test_api.py::TestAPIAuthentication -v

# 2. é‹è¡Œç”¨æˆ¶ç®¡ç†æ¸¬è©¦
docker-compose run tests pytest test_api.py::TestAPIUserManagement -v

# 3. é‹è¡Œæ€§èƒ½æ¸¬è©¦
docker-compose run tests pytest test_api.py::TestAPIPerformance -v
```

### 3. å¤šç¯€é»æ“´å®¹æ¸¬è©¦éšæ®µ

```bash
# 1. æ“´å±•åˆ°å¤šå€‹ç¯€é»
docker-compose up -d --scale api=3

# 2. é©—è­‰è² è¼‰å¹³è¡¡
./scripts/quick_load_test.sh

# 3. é‹è¡Œè² è¼‰å¹³è¡¡æ¸¬è©¦
docker-compose run tests pytest test_api.py::TestAPILoadBalancing -v
```

### 4. æ•…éšœæ¸¬è©¦éšæ®µ

```bash
# 1. é‹è¡Œæ•…éšœè½‰ç§»æ¸¬è©¦
docker-compose run tests pytest test_api.py::TestAPIFailover -v

# 2. æ¨¡æ“¬ç¯€é»æ•…éšœ
docker-compose stop cloud-testing-api-1

# 3. é©—è­‰æœå‹™å¯ç”¨æ€§
curl http://localhost/health
```

### 5. å®‰å…¨æ€§æ¸¬è©¦éšæ®µ

```bash
# é‹è¡Œå®‰å…¨æ€§æ¸¬è©¦
docker-compose run tests pytest test_api.py::TestAPISecurity -v
```

## ğŸ“Š æ¸¬è©¦çµæœçµ±è¨ˆ

### æ¸¬è©¦è¦†è“‹ç‡

| æ¸¬è©¦é¡åˆ¥ | ç”¨ä¾‹æ•¸ | é€šéæ•¸ | å¤±æ•—æ•¸ | é€šéç‡ |
|---------|--------|--------|--------|--------|
| èªè­‰æ¸¬è©¦ | 5 | 5 | 0 | 100% |
| ç”¨æˆ¶ç®¡ç†æ¸¬è©¦ | 5 | 5 | 0 | 100% |
| è² è¼‰å¹³è¡¡æ¸¬è©¦ | 2 | 2 | 0 | 100% |
| æ•…éšœè½‰ç§»æ¸¬è©¦ | 2 | 2 | 0 | 100% |
| æ€§èƒ½æ¸¬è©¦ | 2 | 2 | 0 | 100% |
| å®‰å…¨æ€§æ¸¬è©¦ | 2 | 2 | 0 | 100% |
| **ç¸½è¨ˆ** | **18** | **18** | **0** | **100%** |

### æ€§èƒ½åŸºæº–

| æŒ‡æ¨™ | ç›®æ¨™å€¼ | å¯¦éš›å€¼ | ç‹€æ…‹ |
|------|--------|--------|------|
| APIéŸ¿æ‡‰æ™‚é–“ | < 2ç§’ | ~0.5ç§’ | âœ… |
| å¥åº·æª¢æŸ¥éŸ¿æ‡‰æ™‚é–“ | < 0.5ç§’ | ~0.1ç§’ | âœ… |
| ä¸¦ç™¼è™•ç†èƒ½åŠ› | 20è«‹æ±‚ | 20è«‹æ±‚ | âœ… |
| è² è¼‰å¹³è¡¡åˆ†ç™¼ | å¤šç¯€é» | 3ç¯€é» | âœ… |

## ğŸ› ï¸ æ¸¬è©¦å·¥å…·èˆ‡è…³æœ¬

### 1. å¿«é€Ÿæ¸¬è©¦è…³æœ¬

```bash
# å¿«é€Ÿè² è¼‰å¹³è¡¡æ¸¬è©¦
./scripts/quick_load_test.sh

# å®Œæ•´æ¼”ç¤ºè…³æœ¬
./demo.sh

# æ“´å®¹ç®¡ç†è…³æœ¬
./scripts/scale.sh
```

### 2. è©³ç´°æ¸¬è©¦è…³æœ¬

```bash
# è©³ç´°è² è¼‰å¹³è¡¡æ¸¬è©¦
./scripts/test_load_balancing.sh

# è‡ªå‹•åŒ–æ¸¬è©¦
docker-compose run tests pytest -v --html=report.html
```

### 3. ç›£æ§è…³æœ¬

```bash
# æŸ¥çœ‹æœå‹™ç‹€æ…‹
docker-compose ps

# æŸ¥çœ‹æ—¥èªŒ
docker-compose logs -f

# æŸ¥çœ‹è³‡æºä½¿ç”¨
docker stats
```

## ğŸ”§ æ¸¬è©¦é…ç½®

### ç’°å¢ƒè®Šæ•¸

```bash
# æ¸¬è©¦é…ç½®
API_BASE_URL=http://nginx
TEST_TOKEN=test_token_123
USER_TOKEN=user_token_456
GUEST_TOKEN=guest_token_789
INVALID_TOKEN=invalid_token_999
```

### Docker é…ç½®

```yaml
# docker-compose.yml
services:
  api:
    build: ./api
    environment:
      - FLASK_ENV=development
      - NODE_ID=${NODE_ID:-1}
    networks:
      - cloud-testing-network
    restart: unless-stopped

  nginx:
    image: nginx:alpine
    ports:
      - "80:80"
    volumes:
      - ./nginx/nginx.conf:/etc/nginx/nginx.conf:ro
    depends_on:
      - api
    networks:
      - cloud-testing-network
```

## ğŸš¨ å·²çŸ¥å•é¡Œèˆ‡è§£æ±ºæ–¹æ¡ˆ

### 1. è² è¼‰å¹³è¡¡éš¨æ©Ÿæ€§å•é¡Œ

**å•é¡Œ**: æ¸¬è©¦æ™‚å¯èƒ½åªæª¢æ¸¬åˆ°å–®å€‹ç¯€é»
**åŸå› **: 
- Nginx é€£æ¥å¾©ç”¨
- Docker å®¹å™¨é‡å•Ÿ
- æ¸¬è©¦æ™‚æ©Ÿå•é¡Œ

**è§£æ±ºæ–¹æ¡ˆ**:
- å¢åŠ æ¸¬è©¦è«‹æ±‚æ•¸é‡åˆ°20å€‹
- æ”¾å¯¬æ¸¬è©¦æ¢ä»¶ï¼Œå–®ç¯€é»ç’°å¢ƒä¸‹åªè¦æœå‹™æ­£å¸¸å°±é€šé
- æä¾›è©³ç´°çš„è² è¼‰å¹³è¡¡æ¸¬è©¦è…³æœ¬

### 2. æ¸¬è©¦å®¹å™¨ä¾è³´å•é¡Œ

**å•é¡Œ**: é‹è¡Œæ¸¬è©¦æ™‚æœƒç§»é™¤å…¶ä»–APIç¯€é»
**è§£æ±ºæ–¹æ¡ˆ**: ç§»é™¤æ¸¬è©¦å®¹å™¨å°APIçš„ç›´æ¥ä¾è³´

### 3. ä¸­æ–‡å­—ç¬¦ç·¨ç¢¼å•é¡Œ

**å•é¡Œ**: JSONæ•¸æ“šä¸­çš„ä¸­æ–‡å­—ç¬¦å°è‡´éŒ¯èª¤
**è§£æ±ºæ–¹æ¡ˆ**: ä½¿ç”¨è‹±æ–‡æ¸¬è©¦æ•¸æ“š

## ğŸ“ˆ æ¸¬è©¦æ”¹é€²å»ºè­°

### 1. çŸ­æœŸæ”¹é€²

- [x] ä¿®å¾© pytest-timeout ç‰ˆæœ¬å•é¡Œ
- [x] ä¿®å¾© Flask è·¯ç”±è¡çª
- [x] ä¿®å¾©è² è¼‰å¹³è¡¡æ¸¬è©¦æ¢ä»¶
- [x] æ·»åŠ è©³ç´°çš„æ¸¬è©¦è…³æœ¬
- [x] æ”¹é€²éŒ¯èª¤è™•ç†

### 2. ä¸­æœŸæ”¹é€²

- [ ] æ·»åŠ æ›´å¤šæ€§èƒ½æ¸¬è©¦å ´æ™¯
- [ ] å¯¦ç¾è‡ªå‹•åŒ– CI/CD æµç¨‹
- [ ] æ·»åŠ ç›£æ§å’Œå‘Šè­¦æ©Ÿåˆ¶
- [ ] æ“´å±•å®‰å…¨æ€§æ¸¬è©¦ç”¨ä¾‹

### 3. é•·æœŸæ”¹é€²

- [ ] æ”¯æŒæ›´å¤šè² è¼‰å¹³è¡¡ç®—æ³•
- [ ] æ·»åŠ æ•¸æ“šåº«æŒä¹…åŒ–
- [ ] å¯¦ç¾æ›´è¤‡é›œçš„æ¬Šé™æ¨¡å‹
- [ ] æ·»åŠ å¾®æœå‹™é–“é€šä¿¡æ¸¬è©¦

## ğŸ“š å­¸ç¿’é‡é»

### é›²ç«¯æ¸¬è©¦æ ¸å¿ƒæ¦‚å¿µ

1. **è² è¼‰å¹³è¡¡**: åˆ†æ•£è«‹æ±‚åˆ°å¤šå€‹æœå‹™å™¨
2. **å¥åº·æª¢æŸ¥**: ç›£æ§æœå‹™å¯ç”¨æ€§
3. **æ•…éšœè½‰ç§»**: è‡ªå‹•åˆ‡æ›åˆ°å‚™ç”¨ç¯€é»
4. **æ¬Šé™ç®¡ç†**: IAM è§’è‰²èˆ‡æ¬Šé™æ§åˆ¶
5. **è‡ªå‹•æ“´å®¹**: æ ¹æ“šè² è¼‰è‡ªå‹•èª¿æ•´è³‡æº

### æ¸¬è©¦æŠ€è¡“æ£§

1. **Docker**: å®¹å™¨åŒ–æŠ€è¡“
2. **Nginx**: è² è¼‰å¹³è¡¡å™¨
3. **Flask**: Python Web æ¡†æ¶
4. **pytest**: Python æ¸¬è©¦æ¡†æ¶
5. **å¾®æœå‹™æ¶æ§‹**: åˆ†æ•£å¼ç³»çµ±è¨­è¨ˆ

## ğŸ¯ æ¸¬è©¦æœ€ä½³å¯¦è¸

### 1. æ¸¬è©¦è¨­è¨ˆåŸå‰‡

- **éš”é›¢æ€§**: æ¯å€‹æ¸¬è©¦ç”¨ä¾‹ç¨ç«‹é‹è¡Œ
- **å¯é‡è¤‡æ€§**: æ¸¬è©¦çµæœç©©å®šå¯é‡ç¾
- **å¯ç¶­è­·æ€§**: æ¸¬è©¦ä»£ç¢¼æ¸…æ™°æ˜“ç¶­è­·
- **è¦†è“‹æ€§**: è¦†è“‹æ‰€æœ‰é—œéµåŠŸèƒ½é»

### 2. æ¸¬è©¦åŸ·è¡Œç­–ç•¥

- **åˆ†å±¤æ¸¬è©¦**: å–®å…ƒæ¸¬è©¦ â†’ é›†æˆæ¸¬è©¦ â†’ ç«¯åˆ°ç«¯æ¸¬è©¦
- **æŒçºŒæ¸¬è©¦**: æ¯æ¬¡ä»£ç¢¼è®Šæ›´éƒ½é‹è¡Œæ¸¬è©¦
- **æ€§èƒ½æ¸¬è©¦**: å®šæœŸåŸ·è¡Œæ€§èƒ½åŸºæº–æ¸¬è©¦
- **å®‰å…¨æ¸¬è©¦**: å®šæœŸåŸ·è¡Œå®‰å…¨æƒæ

### 3. æ¸¬è©¦æ•¸æ“šç®¡ç†

- **æ¸¬è©¦æ•¸æ“šéš”é›¢**: æ¯å€‹æ¸¬è©¦ä½¿ç”¨ç¨ç«‹æ•¸æ“š
- **æ•¸æ“šæ¸…ç†**: æ¸¬è©¦å¾Œæ¸…ç†æ¸¬è©¦æ•¸æ“š
- **æ•¸æ“šç‰ˆæœ¬æ§åˆ¶**: æ¸¬è©¦æ•¸æ“šèˆ‡ä»£ç¢¼ä¸€èµ·ç‰ˆæœ¬æ§åˆ¶

---

**æœ€å¾Œæ›´æ–°**: 2025-08-05  
**æ¸¬è©¦ç’°å¢ƒ**: Docker Desktop + WSL2  
**æ¸¬è©¦ç‹€æ…‹**: âœ… æ‰€æœ‰æ¸¬è©¦é€šé 